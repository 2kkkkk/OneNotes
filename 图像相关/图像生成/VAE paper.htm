<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:dt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name=ProgId content=OneNote.File>
<meta name=Generator content="Microsoft OneNote 15">
<link id=Main-File rel=Main-File href="VAE%20paper.htm">
<link rel=File-List href="VAE%20paper.files/filelist.xml">
</head>

<body lang=zh-CN style='font-family:微软雅黑;font-size:12.0pt'>

<div style='direction:ltr;border-width:100%'>

<div style='direction:ltr;margin-top:0in;margin-left:0in;width:27.7618in'>

<div style='direction:ltr;margin-top:0in;margin-left:0in;width:1.925in'>

<p style='margin:0in;font-family:微软雅黑;font-size:20.0pt' lang=en-US>VAE paper</p>

</div>

<div style='direction:ltr;margin-top:.0423in;margin-left:0in;width:1.5979in'>

<p style='margin:0in;font-size:10.0pt;color:#767676'><span style='font-family:
Calibri'>2025</span><span style='font-family:微软雅黑'>年</span><span
style='font-family:Calibri'>9</span><span style='font-family:微软雅黑'>月</span><span
style='font-family:Calibri'>12</span><span style='font-family:微软雅黑'>日</span></p>

<p style='margin:0in;font-family:Calibri;font-size:10.0pt;color:#767676'>9:03</p>

</div>

<div style='direction:ltr;margin-top:.7236in;margin-left:.6493in;width:27.1125in'>

<p style='margin:0in;margin-left:1.5in'><img
src="VAE%20paper.files/image001.jpg" width=701 height=208></p>

<p style='margin:0in;font-family:微软雅黑;font-size:12.0pt'>&nbsp;</p>

<p style='margin:0in;font-size:12.0pt'><span style='font-weight:bold;
font-family:微软雅黑' lang=en-US>X</span><span style='font-family:微软雅黑' lang=zh-CN>表示图片数据集，</span><!--[if gte msEquation 12]><m:oMath xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"><m:sSup><m:sSupPr><m:ctrlPr/></m:sSupPr><m:e><m:r><m:t>&#119909;</m:t></m:r></m:e><m:sup><m:r><m:t>(</m:t></m:r><m:r><m:t>&#119894;</m:t></m:r><m:r><m:t>)</m:t></m:r></m:sup></m:sSup></m:oMath><![endif]--><span
style='font-family:微软雅黑' lang=zh-CN>表示一张图片。假设</span><!--[if gte msEquation 12]><m:oMath xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"><m:sSup><m:sSupPr><m:ctrlPr/></m:sSupPr><m:e><m:r><m:t>&#119909;</m:t></m:r></m:e><m:sup><m:r><m:t>(</m:t></m:r><m:r><m:t>&#119894;</m:t></m:r><m:r><m:t>)</m:t></m:r></m:sup></m:sSup></m:oMath><![endif]--><span
style='font-family:微软雅黑' lang=zh-CN>的生成过程中涉及到某个未被观测到的连续随机变量</span><span
style='font-family:"Cambria Math"' lang=en-US>z</span><span style='font-family:
SimSun' lang=zh-CN>，</span><!--[if gte msEquation 12]><m:oMath xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"><m:sSup><m:sSupPr><m:ctrlPr/></m:sSupPr><m:e><m:r><m:t>&#119909;</m:t></m:r></m:e><m:sup><m:r><m:t>(</m:t></m:r><m:r><m:t>&#119894;</m:t></m:r><m:r><m:t>)</m:t></m:r></m:sup></m:sSup></m:oMath><![endif]--><span
style='font-family:微软雅黑' lang=zh-CN>的生成过程分为</span><span style='font-family:
微软雅黑' lang=en-US> </span><span style='font-family:微软雅黑' lang=zh-CN>两步：</span><![if !msEquation]><img
src="VAE%20paper.files/image002.png" width=1460 height=42><![endif]></p>

<p style='margin:0in;margin-left:.375in;font-size:12.0pt'><span
style='font-family:微软雅黑' lang=en-US>1</span><span style='font-family:微软雅黑'
lang=zh-CN>）从某个分布</span><!--[if gte msEquation 12]><m:oMath xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"><m:sSub><m:sSubPr><m:ctrlPr/></m:sSubPr><m:e><m:r><m:t>&#119901;</m:t></m:r></m:e><m:sub><m:r><m:t>&#120579;</m:t></m:r></m:sub></m:sSub><m:d><m:dPr><m:ctrlPr/></m:dPr><m:e><m:r><m:t>&#119911;</m:t></m:r></m:e></m:d></m:oMath><![endif]--><span
style='font-family:微软雅黑' lang=zh-CN>中采样生成</span><!--[if gte msEquation 12]><m:oMath xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"><m:sSup><m:sSupPr><m:ctrlPr/></m:sSupPr><m:e><m:r><m:t>&#119911;</m:t></m:r></m:e><m:sup><m:r><m:t>(</m:t></m:r><m:r><m:t>&#119894;</m:t></m:r><m:r><m:t>)</m:t></m:r></m:sup></m:sSup></m:oMath><![endif]--><![if !msEquation]><img
src="VAE%20paper.files/image003.png" width=462 height=42><![endif]></p>

<p style='margin:0in;margin-left:.375in;font-size:12.0pt'><span
style='font-family:微软雅黑' lang=en-US>2</span><span style='font-family:微软雅黑'
lang=zh-CN>）再从条件分布</span><!--[if gte msEquation 12]><m:oMath xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"><m:sSub><m:sSubPr><m:ctrlPr/></m:sSubPr><m:e><m:r><m:t>&#119901;</m:t></m:r></m:e><m:sub><m:r><m:t>&#120579;</m:t></m:r></m:sub></m:sSub><m:d><m:dPr><m:ctrlPr/></m:dPr><m:e><m:r><m:t>&#119909;</m:t></m:r></m:e><m:e><m:r><m:t>&#119911;</m:t></m:r></m:e></m:d></m:oMath><![endif]--><span
style='font-family:微软雅黑' lang=zh-CN>中生成</span><!--[if gte msEquation 12]><m:oMath xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"><m:sSup><m:sSupPr><m:ctrlPr/></m:sSupPr><m:e><m:r><m:t>&#119909;</m:t></m:r></m:e><m:sup><m:r><m:t>(</m:t></m:r><m:r><m:t>&#119894;</m:t></m:r><m:r><m:t>)</m:t></m:r></m:sup></m:sSup></m:oMath><![endif]--><![if !msEquation]><img
src="VAE%20paper.files/image004.png" width=461 height=42><![endif]></p>

<p style='margin:0in;margin-left:.375in;font-family:微软雅黑;font-size:12.0pt'>&nbsp;</p>

<p style='margin:0in;margin-left:1.125in'><img
src="VAE%20paper.files/image005.jpg" width=633 height=207></p>

<p style='margin:0in;font-family:微软雅黑;font-size:12.0pt'>&nbsp;</p>

<p style='margin:0in;font-size:12.0pt'><span style='font-family:微软雅黑'
lang=zh-CN>我们用</span><!--[if gte msEquation 12]><m:oMath xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"><m:sSub><m:sSubPr><m:ctrlPr/></m:sSubPr><m:e><m:r><m:t>&#119902;</m:t></m:r></m:e><m:sub><m:r><m:rPr><m:sty m:val="p"/></m:rPr><m:t>Φ</m:t></m:r></m:sub></m:sSub><m:d><m:dPr><m:ctrlPr/></m:dPr><m:e><m:r><m:t>&#119911;</m:t></m:r></m:e><m:e><m:r><m:t>&#119909;</m:t></m:r></m:e></m:d></m:oMath><![endif]--><span
style='font-family:微软雅黑' lang=zh-CN>来近似真实后验</span><!--[if gte msEquation 12]><m:oMath xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"><m:sSub><m:sSubPr><m:ctrlPr/></m:sSubPr><m:e><m:r><m:t>&#119901;</m:t></m:r></m:e><m:sub><m:r><m:t>&#120579;</m:t></m:r></m:sub></m:sSub><m:d><m:dPr><m:ctrlPr/></m:dPr><m:e><m:r><m:t>&#119911;</m:t></m:r></m:e><m:e><m:r><m:t>&#119909;</m:t></m:r></m:e></m:d></m:oMath><![endif]--><span
style='font-family:微软雅黑' lang=zh-CN>，</span><!--[if gte msEquation 12]><m:oMath xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"><m:sSub><m:sSubPr><m:ctrlPr/></m:sSubPr><m:e><m:r><m:t>&#119902;</m:t></m:r></m:e><m:sub><m:r><m:rPr><m:sty m:val="p"/></m:rPr><m:t>Φ</m:t></m:r></m:sub></m:sSub><m:d><m:dPr><m:ctrlPr/></m:dPr><m:e><m:r><m:t>&#119911;</m:t></m:r></m:e><m:e><m:r><m:t>&#119909;</m:t></m:r></m:e></m:d></m:oMath><![endif]--><span
style='font-family:微软雅黑' lang=zh-CN>也被称为</span><span style='font-weight:bold;
font-family:微软雅黑' lang=en-US>probabilistic encoder</span><span
style='font-family:微软雅黑' lang=zh-CN>，因为给定一个</span><span style='font-family:
微软雅黑' lang=en-US>x</span><span style='font-family:微软雅黑' lang=zh-CN>，</span><!--[if gte msEquation 12]><m:oMath xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"><m:sSub><m:sSubPr><m:ctrlPr/></m:sSubPr><m:e><m:r><m:t>&#119902;</m:t></m:r></m:e><m:sub><m:r><m:rPr><m:sty m:val="p"/></m:rPr><m:t>Φ</m:t></m:r></m:sub></m:sSub><m:d><m:dPr><m:ctrlPr/></m:dPr><m:e><m:r><m:t>&#119911;</m:t></m:r></m:e><m:e><m:r><m:t>&#119909;</m:t></m:r></m:e></m:d></m:oMath><![endif]--><span
style='font-family:微软雅黑' lang=zh-CN>输出的是关于</span><span style='font-family:微软雅黑'
lang=en-US>z</span><span style='font-family:微软雅黑' lang=zh-CN>的概率分布。</span><!--[if gte msEquation 12]><m:oMath xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"><m:sSub><m:sSubPr><m:ctrlPr/></m:sSubPr><m:e><m:r><m:t>&#119901;</m:t></m:r></m:e><m:sub><m:r><m:t>&#120579;</m:t></m:r></m:sub></m:sSub><m:d><m:dPr><m:ctrlPr/></m:dPr><m:e><m:r><m:t>&#119909;</m:t></m:r></m:e><m:e><m:r><m:t>&#119911;</m:t></m:r></m:e></m:d></m:oMath><![endif]--><span
style='font-family:微软雅黑' lang=zh-CN>也被称为</span><span style='font-weight:bold;
font-family:微软雅黑' lang=en-US>probabilistic decoder</span><span
style='font-family:微软雅黑' lang=zh-CN>，因为给定一个</span><span style='font-family:
微软雅黑' lang=en-US>z</span><span style='font-family:微软雅黑' lang=zh-CN>，</span><!--[if gte msEquation 12]><m:oMath xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"><m:sSub><m:sSubPr><m:ctrlPr/></m:sSubPr><m:e><m:r><m:t>&#119901;</m:t></m:r></m:e><m:sub><m:r><m:t>&#120579;</m:t></m:r></m:sub></m:sSub><m:d><m:dPr><m:ctrlPr/></m:dPr><m:e><m:r><m:t>&#119909;</m:t></m:r></m:e><m:e><m:r><m:t>&#119911;</m:t></m:r></m:e></m:d></m:oMath><![endif]--><span
style='font-family:微软雅黑' lang=zh-CN>输出的是关于</span><span style='font-family:微软雅黑'
lang=en-US>x</span><span style='font-family:微软雅黑' lang=zh-CN>的概率分布。</span><![if !msEquation]><img
src="VAE%20paper.files/image006.png" width=2546 height=42><![endif]></p>

<p style='margin:0in;font-family:微软雅黑;font-size:12.0pt'>&nbsp;</p>

<p style='margin:0in;font-size:12.0pt'><span style='font-weight:bold;
font-family:微软雅黑' lang=zh-CN>也就是说，我们既想要求得</span><!--[if gte msEquation 12]><m:oMath xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"><m:sSub><m:sSubPr><m:ctrlPr/></m:sSubPr><m:e><m:r><m:t>&#119954;</m:t></m:r></m:e><m:sub><m:r><m:t>&#120625;</m:t></m:r></m:sub></m:sSub><m:d><m:dPr><m:ctrlPr/></m:dPr><m:e><m:r><m:t>&#119963;</m:t></m:r></m:e><m:e><m:r><m:t>&#119961;</m:t></m:r></m:e></m:d></m:oMath><![endif]--><span
style='font-weight:bold;font-family:微软雅黑' lang=zh-CN>作为我们的</span><span
style='font-weight:bold;font-family:"Cambria Math"' lang=en-US>encoder</span><span
style='font-weight:bold;font-family:微软雅黑' lang=zh-CN>，又想要求得</span><!--[if gte msEquation 12]><m:oMath xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"><m:sSub><m:sSubPr><m:ctrlPr/></m:sSubPr><m:e><m:r><m:t>&#119953;</m:t></m:r></m:e><m:sub><m:r><m:t>&#120637;</m:t></m:r></m:sub></m:sSub><m:d><m:dPr><m:ctrlPr/></m:dPr><m:e><m:r><m:t>&#119961;</m:t></m:r></m:e><m:e><m:r><m:t>&#119963;</m:t></m:r></m:e></m:d></m:oMath><![endif]--><span
style='font-weight:bold;font-family:微软雅黑' lang=zh-CN>作为我们的</span><span
style='font-weight:bold;font-family:"Cambria Math"' lang=en-US>decoder</span><span
style='font-weight:bold;font-family:SimSun' lang=zh-CN>。</span><span
style='font-weight:bold;font-family:微软雅黑' lang=zh-CN>求分布的参数，还是通过极大似然法。</span><![if !msEquation]><img
src="VAE%20paper.files/image007.png" width=1541 height=42><![endif]></p>

<p style='margin:0in;font-family:微软雅黑;font-size:12.0pt'>似然函数：</p>

<p style='margin:0in;margin-left:1.5in'><img
src="VAE%20paper.files/image008.jpg" width=752 height=419></p>

<p style='margin:0in;font-family:微软雅黑;font-size:12.0pt'>&nbsp;</p>

<p style='margin:0in;font-family:微软雅黑;font-size:12.0pt'><span lang=zh-CN>从式（</span><span
lang=en-US>2</span><span lang=zh-CN>）看出，似然函数可以写成</span><span lang=en-US>2</span><span
lang=zh-CN>部分，第一项是</span><span lang=en-US>KL</span><span lang=zh-CN>散度，第二项叫做</span><span
lang=en-US>ELBO</span><span lang=zh-CN>，</span></p>

<p style='margin:0in;font-family:微软雅黑;font-size:12.0pt'>&nbsp;</p>

<p style='margin:0in;font-family:微软雅黑;font-size:12.0pt' lang=en-US><span
style='font-weight:bold'>1 ELBO:</span></p>

<p style='margin:0in;margin-left:.375in;font-family:微软雅黑;font-size:12.0pt'><span
lang=zh-CN>其中，</span><span lang=en-US>ELBO</span><span lang=zh-CN>可以写成上图中</span><span
style='font-weight:bold' lang=zh-CN>公式（</span><span style='font-weight:bold'
lang=en-US>2</span><span style='font-weight:bold' lang=zh-CN>）和公式（</span><span
style='font-weight:bold' lang=en-US>3</span><span style='font-weight:bold'
lang=zh-CN>）两种形式</span><span lang=zh-CN>，</span></p>

<ul type=circle style='direction:ltr;unicode-bidi:embed;margin-top:0in;
 margin-bottom:0in'>
 <li style='margin-top:0;margin-bottom:0;vertical-align:middle'><span
     style='font-family:微软雅黑;font-size:12.0pt' lang=zh-CN>对于公式（</span><span
     style='font-family:微软雅黑;font-size:12.0pt' lang=en-US>2</span><span
     style='font-family:微软雅黑;font-size:12.0pt' lang=zh-CN>）来说，是一个期望，期望可以通过</span><span
     style='font-family:微软雅黑;font-size:12.0pt' lang=en-US>monte carlo </span><span
     style='font-family:微软雅黑;font-size:12.0pt' lang=zh-CN>采样得到估计值，但是这个估计的方差太大，无法使用（具体推导不清楚）。最关键的是，</span><span
     style='font-weight:bold;font-family:微软雅黑;font-size:12.0pt' lang=zh-CN>采样的过程是不可导的，我们想求得</span><span
     style='font-weight:bold;font-family:微软雅黑;font-size:12.0pt' lang=en-US>L</span><span
     style='font-weight:bold;font-family:微软雅黑;font-size:12.0pt' lang=zh-CN>对分布参数</span><!--[if gte msEquation 12]><m:oMath xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"><m:r><m:t>&#120659;</m:t></m:r></m:oMath><![endif]--><span
     style='font-weight:bold;font-family:微软雅黑;font-size:12.0pt' lang=zh-CN>的导数，但是</span><span
     style='font-weight:bold;font-family:微软雅黑;font-size:12.0pt' lang=en-US>L</span><span
     style='font-weight:bold;font-family:微软雅黑;font-size:12.0pt' lang=zh-CN>中包含期望，求期望需要我们进行采样来估计这个期望，而采样涉及到从</span><!--[if gte msEquation 12]><m:oMath xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"><m:sSub><m:sSubPr><m:ctrlPr/></m:sSubPr><m:e><m:r><m:t>&#119954;</m:t></m:r></m:e><m:sub><m:r><m:t>&#120625;</m:t></m:r></m:sub></m:sSub><m:d><m:dPr><m:ctrlPr/></m:dPr><m:e><m:r><m:t>&#119963;</m:t></m:r></m:e><m:e><m:r><m:t>&#119961;</m:t></m:r></m:e></m:d></m:oMath><![endif]--><span
     style='font-weight:bold;font-family:微软雅黑;font-size:12.0pt' lang=zh-CN>这个分布中采样得到</span><span
     style='font-weight:bold;font-family:微软雅黑;font-size:12.0pt' lang=en-US>z</span><span
     style='font-weight:bold;font-family:微软雅黑;font-size:12.0pt' lang=zh-CN>，这个过程是对</span><!--[if gte msEquation 12]><m:oMath xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"><m:r><m:t>&#120625;</m:t></m:r></m:oMath><![endif]--><span
     style='font-weight:bold;font-family:微软雅黑;font-size:12.0pt' lang=zh-CN>是不可导的。</span><![if !msEquation]><img
     src="VAE%20paper.files/image009.png" width=3811 height=42><![endif]></li>
</ul>

<p style='margin:0in;margin-left:.75in;font-family:微软雅黑;font-size:12.0pt'>&nbsp;</p>

<p style='margin:0in;margin-left:1.125in'><img
src="VAE%20paper.files/image010.jpg" width=717 height=456></p>

<p style='margin:0in;margin-left:.75in;font-family:微软雅黑;font-size:12.0pt'>&nbsp;</p>

<p style='margin:0in;margin-left:.75in;font-size:12.0pt'><span
style='font-family:微软雅黑' lang=zh-CN>我们可以用重参数化技巧：公式（</span><span
style='font-family:微软雅黑' lang=en-US>4</span><span style='font-family:微软雅黑'
lang=zh-CN>），将原来的</span><!--[if gte msEquation 12]><m:oMath xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"><m:r><m:rPr><m:sty m:val="p"/></m:rPr><m:t>z</m:t></m:r><m:r><m:t>~</m:t></m:r><m:sSub><m:sSubPr><m:ctrlPr/></m:sSubPr><m:e><m:r><m:t>&#119902;</m:t></m:r></m:e><m:sub><m:r><m:rPr><m:sty m:val="p"/></m:rPr><m:t>Φ</m:t></m:r></m:sub></m:sSub><m:d><m:dPr><m:ctrlPr/></m:dPr><m:e><m:r><m:t>&#119911;</m:t></m:r></m:e><m:e><m:r><m:t>&#119909;</m:t></m:r></m:e></m:d></m:oMath><![endif]--><span
style='font-family:微软雅黑' lang=zh-CN>变成</span><!--[if gte msEquation 12]><m:oMath xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"><m:r><m:rPr><m:sty m:val="p"/></m:rPr><m:t>z</m:t></m:r><m:r><m:t>=</m:t></m:r><m:sSub><m:sSubPr><m:ctrlPr/></m:sSubPr><m:e><m:r><m:t>&#119892;</m:t></m:r></m:e><m:sub><m:r><m:rPr><m:sty m:val="p"/></m:rPr><m:t>Φ</m:t></m:r></m:sub></m:sSub><m:d><m:dPr><m:ctrlPr/></m:dPr><m:e><m:r><m:t>&#120598;</m:t></m:r><m:r><m:t>,</m:t></m:r><m:r><m:t>&#119909;</m:t></m:r></m:e></m:d></m:oMath><![endif]--><span
style='font-family:微软雅黑' lang=zh-CN>，也就说，原来的</span><span style='font-family:
微软雅黑' lang=en-US>z</span><span style='font-family:微软雅黑' lang=zh-CN>是从</span><!--[if gte msEquation 12]><m:oMath xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"><m:sSub><m:sSubPr><m:ctrlPr/></m:sSubPr><m:e><m:r><m:t>&#119902;</m:t></m:r></m:e><m:sub><m:r><m:rPr><m:sty m:val="p"/></m:rPr><m:t>Φ</m:t></m:r></m:sub></m:sSub><m:d><m:dPr><m:ctrlPr/></m:dPr><m:e><m:r><m:t>&#119911;</m:t></m:r></m:e><m:e><m:r><m:t>&#119909;</m:t></m:r></m:e></m:d></m:oMath><![endif]--><span
style='font-family:微软雅黑' lang=zh-CN>这个分布中采样得到的，重参数化之后，</span><span
style='font-family:微软雅黑' lang=en-US>z</span><span style='font-family:微软雅黑'
lang=zh-CN>是由函数</span><!--[if gte msEquation 12]><m:oMath xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"><m:sSub><m:sSubPr><m:ctrlPr/></m:sSubPr><m:e><m:r><m:t>&#119892;</m:t></m:r></m:e><m:sub><m:r><m:rPr><m:sty m:val="p"/></m:rPr><m:t>Φ</m:t></m:r></m:sub></m:sSub><m:d><m:dPr><m:ctrlPr/></m:dPr><m:e><m:r><m:t>&#120598;</m:t></m:r><m:r><m:t>,</m:t></m:r><m:r><m:t>&#119909;</m:t></m:r></m:e></m:d></m:oMath><![endif]--><span
style='font-family:微软雅黑' lang=zh-CN>得到的。经过公式（</span><span style='font-family:
微软雅黑' lang=en-US>4</span><span style='font-family:微软雅黑' lang=zh-CN>）重写之后，公式（</span><span
style='font-family:微软雅黑' lang=en-US>2</span><span style='font-family:微软雅黑'
lang=zh-CN>）的估计值可以写成公式（</span><span style='font-family:微软雅黑' lang=en-US>6</span><span
style='font-family:微软雅黑' lang=zh-CN>）的形式，这个估计值的方差就变小了？，</span><span
style='font-weight:bold;font-family:微软雅黑' lang=zh-CN>关键是使</span><span
style='font-weight:bold;font-family:微软雅黑' lang=en-US>L</span><span
style='font-weight:bold;font-family:微软雅黑' lang=zh-CN>对参数</span><!--[if gte msEquation 12]><m:oMath xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"><m:r><m:t>&#120625;</m:t></m:r></m:oMath><![endif]--><span
style='font-weight:bold;font-family:微软雅黑' lang=zh-CN>变得可导了。</span><![if !msEquation]><img
src="VAE%20paper.files/image011.png" width=3418 height=42><![endif]></p>

<ul type=circle style='direction:ltr;unicode-bidi:embed;margin-top:0in;
 margin-bottom:0in'>
 <li style='margin-top:0;margin-bottom:0;vertical-align:middle'><span
     style='font-family:微软雅黑;font-size:12.0pt' lang=zh-CN>对于式（</span><span
     style='font-family:微软雅黑;font-size:12.0pt' lang=en-US>3</span><span
     style='font-family:微软雅黑;font-size:12.0pt' lang=zh-CN>）来说，同样有一个期望项，这个期望也通过重参数化技巧变得可导了。公式（</span><span
     style='font-family:微软雅黑;font-size:12.0pt' lang=en-US>3</span><span
     style='font-family:微软雅黑;font-size:12.0pt' lang=zh-CN>）由</span><span
     style='font-family:微软雅黑;font-size:12.0pt' lang=en-US>2</span><span
     style='font-family:微软雅黑;font-size:12.0pt' lang=zh-CN>项组成，第一部分是</span><span
     style='font-family:微软雅黑;font-size:12.0pt' lang=en-US>KL</span><span
     style='font-family:微软雅黑;font-size:12.0pt' lang=zh-CN>散度，也可以看作是正则项，约束</span><span
     style='font-family:微软雅黑;font-size:12.0pt' lang=en-US>probabilistic encoder</span><!--[if gte msEquation 12]><m:oMath xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"><m:r><m:rPr><m:sty m:val="p"/></m:rPr><m:t>Φ</m:t></m:r></m:oMath><![endif]--><span
     style='font-family:微软雅黑;font-size:12.0pt' lang=zh-CN>逼近先验</span><!--[if gte msEquation 12]><m:oMath xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"><m:sSub><m:sSubPr><m:ctrlPr/></m:sSubPr><m:e><m:r><m:t>&#119901;</m:t></m:r></m:e><m:sub><m:r><m:t>&#120579;</m:t></m:r></m:sub></m:sSub><m:d><m:dPr><m:ctrlPr/></m:dPr><m:e><m:r><m:t>&#119911;</m:t></m:r></m:e></m:d></m:oMath><![endif]--><span
     style='font-family:微软雅黑;font-size:12.0pt' lang=zh-CN>。第二部分可以看作是</span><span
     style='font-family:微软雅黑;font-size:12.0pt' lang=en-US>auto encoder</span><span
     style='font-family:微软雅黑;font-size:12.0pt' lang=zh-CN>中的重构误差。且在实验中，采样的步数</span><span
     style='font-family:微软雅黑;font-size:12.0pt' lang=en-US>L</span><span
     style='font-family:微软雅黑;font-size:12.0pt' lang=zh-CN>可以只设置为</span><span
     style='font-family:微软雅黑;font-size:12.0pt' lang=en-US>1</span><span
     style='font-family:微软雅黑;font-size:12.0pt' lang=zh-CN>步，只要</span><span
     style='font-family:微软雅黑;font-size:12.0pt' lang=en-US>batch_size</span><span
     style='font-family:微软雅黑;font-size:12.0pt' lang=zh-CN>足够大即可。</span><![if !msEquation]><img
     src="VAE%20paper.files/image012.png" width=3490 height=42><![endif]></li>
</ul>

<p style='margin:0in;margin-left:.75in;font-family:微软雅黑;font-size:12.0pt'>&nbsp;</p>

<p style='margin:0in;margin-left:1.125in'><img
src="VAE%20paper.files/image013.jpg" width=747 height=532></p>

<p style='margin:0in;font-family:微软雅黑;font-size:12.0pt'>&nbsp;</p>

<p style='margin:0in;font-family:微软雅黑;font-size:12.0pt'><span style='font-weight:
bold' lang=en-US>2 </span><span style='font-weight:bold' lang=zh-CN>关于重参数化：</span></p>

<p style='margin:0in;margin-left:.375in;font-family:微软雅黑;font-size:12.0pt'
lang=en-US><span style='mso-spacerun:yes'> </span></p>

<p style='margin:0in;margin-left:1.125in'><img
src="VAE%20paper.files/image014.jpg" width=765 height=529></p>

<p style='margin:0in;margin-left:1.5in;font-family:微软雅黑;font-size:12.0pt'>&nbsp;</p>

<p style='margin:0in;margin-left:.375in;font-size:12.0pt'><span
style='font-family:微软雅黑' lang=zh-CN>重参数化使得采样过程变得可导，</span><span
style='font-weight:bold;font-family:微软雅黑' lang=zh-CN>以高斯分布为例，原来的</span><!--[if gte msEquation 12]><m:oMath xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"><m:r><m:t>&#119859;</m:t></m:r><m:r><m:t>~</m:t></m:r><m:r><m:t>ℕ</m:t></m:r><m:r><m:t>(</m:t></m:r><m:r><m:t>&#120641;</m:t></m:r><m:r><m:t>，</m:t></m:r><m:r><m:t>&#120648;</m:t></m:r><m:r><m:t>^</m:t></m:r><m:r><m:t>&#120784;</m:t></m:r><m:r><m:t>)</m:t></m:r></m:oMath><![endif]--><span
style='font-weight:bold;font-family:微软雅黑' lang=zh-CN>，重参数化之后，</span><span
style='font-weight:bold;font-family:"Cambria Math"' lang=en-US>z=u+</span><!--[if gte msEquation 12]><m:oMath xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"><m:r><m:t>&#120648;&#120656;</m:t></m:r></m:oMath><![endif]--><span
style='font-weight:bold;font-family:微软雅黑' lang=zh-CN>，这就使得整个损失函数变得可导了。</span><![if !msEquation]><img
src="VAE%20paper.files/image015.png" width=1546 height=42><![endif]></p>

<p style='margin:0in;margin-left:.375in;font-family:微软雅黑;font-size:12.0pt'><span
lang=zh-CN>关于如何选择重参数化的函数</span><span lang=en-US>g</span><span lang=zh-CN>，（这部分懒得看）</span></p>

<p style='margin:0in;margin-left:1.125in'><img
src="VAE%20paper.files/image016.jpg" width=891 height=411></p>

<p style='margin:0in;margin-left:.375in;font-family:微软雅黑;font-size:12.0pt'>&nbsp;</p>

<p style='margin:0in;margin-left:.375in;font-family:微软雅黑;font-size:12.0pt'>&nbsp;</p>

<p style='margin:0in;font-family:微软雅黑;font-size:12.0pt'><span style='font-weight:
bold'>3 Example: Variational Auto-Encoder</span></p>

<p style='margin:0in;margin-left:.375in;font-size:12.0pt'><span
style='font-family:微软雅黑' lang=zh-CN>假设隐变量</span><span style='font-family:微软雅黑'
lang=en-US>z</span><span style='font-family:微软雅黑' lang=zh-CN>的先验是</span><span
style='font-weight:bold;font-family:微软雅黑' lang=zh-CN>标准高斯分布</span><span
style='font-family:微软雅黑' lang=zh-CN>，N(z; 0; I)，并假设</span><span
style='font-family:微软雅黑' lang=en-US>probalistic encoder </span><!--[if gte msEquation 12]><m:oMath xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"><m:sSub><m:sSubPr><m:ctrlPr/></m:sSubPr><m:e><m:r><m:t>&#119902;</m:t></m:r></m:e><m:sub><m:r><m:rPr><m:sty m:val="p"/></m:rPr><m:t>Φ</m:t></m:r></m:sub></m:sSub><m:d><m:dPr><m:ctrlPr/></m:dPr><m:e><m:r><m:t>&#119911;</m:t></m:r></m:e><m:e><m:r><m:t>&#119909;</m:t></m:r></m:e></m:d></m:oMath><![endif]--><span
style='font-family:微软雅黑' lang=en-US><span style='mso-spacerun:yes'>  </span></span><span
style='font-family:微软雅黑' lang=zh-CN>和</span><span style='font-family:微软雅黑'
lang=en-US> probalistic decoder </span><!--[if gte msEquation 12]><m:oMath xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"><m:sSub><m:sSubPr><m:ctrlPr/></m:sSubPr><m:e><m:r><m:t>&#119901;</m:t></m:r></m:e><m:sub><m:r><m:t>&#120579;</m:t></m:r></m:sub></m:sSub><m:d><m:dPr><m:ctrlPr/></m:dPr><m:e><m:r><m:t>&#119909;</m:t></m:r></m:e><m:e><m:r><m:t>&#119911;</m:t></m:r></m:e></m:d></m:oMath><![endif]--><span
style='font-family:微软雅黑' lang=zh-CN>都是</span><span style='font-weight:bold;
font-family:微软雅黑' lang=zh-CN>高斯分布</span><span style='font-family:微软雅黑'
lang=zh-CN>，</span><span style='font-weight:bold;font-family:微软雅黑' lang=zh-CN>这两个分布的参数（均值、方差）分别由神经网络拟合得到。</span><![if !msEquation]><img
src="VAE%20paper.files/image017.png" width=2155 height=42><![endif]></p>

<p style='margin:0in;margin-left:.375in;font-family:微软雅黑;font-size:12.0pt'>&nbsp;</p>

<p style='margin:0in;margin-left:1.125in'><img
src="VAE%20paper.files/image018.jpg" width=962 height=618></p>

<p style='margin:0in;margin-left:1.125in;font-family:微软雅黑;font-size:12.0pt'>&nbsp;</p>

<p style='margin:0in;margin-left:.375in;font-size:12.0pt'><span
style='font-family:微软雅黑' lang=zh-CN>式（</span><span style='font-family:微软雅黑'
lang=en-US>10</span><span style='font-family:微软雅黑' lang=zh-CN>）即式（</span><span
style='font-family:微软雅黑' lang=en-US>7</span><span style='font-family:微软雅黑'
lang=zh-CN>）</span><span style='font-family:微软雅黑' lang=en-US>,ELBO</span><span
style='font-family:微软雅黑' lang=zh-CN>的第二种形式，式（</span><span style='font-family:
微软雅黑' lang=en-US>10</span><span style='font-family:微软雅黑' lang=zh-CN>）的</span><span
style='font-family:微软雅黑' lang=en-US>LOSS</span><span style='font-family:微软雅黑'
lang=zh-CN>分为两部分，第一部分是</span><span style='font-weight:bold;font-family:微软雅黑'
lang=en-US>probalistic </span><span style='font-family:微软雅黑' lang=en-US>encoder</span><span
style='font-family:微软雅黑' lang=zh-CN>的</span><span style='font-family:微软雅黑'
lang=en-US>loss</span><span style='font-family:微软雅黑' lang=zh-CN>，由于是高斯分布，所以可以写成这样的形式，</span><span
style='font-weight:bold;font-family:微软雅黑' lang=zh-CN>神经网络的输入是</span><span
style='font-weight:bold;font-family:微软雅黑' lang=en-US>x(i)</span><span
style='font-weight:bold;font-family:微软雅黑' lang=zh-CN>，输出的是</span><span
style='font-weight:bold;font-family:微软雅黑' lang=en-US>probalistic encoder </span><!--[if gte msEquation 12]><m:oMath xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"><m:sSub><m:sSubPr><m:ctrlPr/></m:sSubPr><m:e><m:r><m:t>&#119954;</m:t></m:r></m:e><m:sub><m:r><m:t>&#120625;</m:t></m:r></m:sub></m:sSub><m:d><m:dPr><m:ctrlPr/></m:dPr><m:e><m:r><m:t>&#119963;</m:t></m:r></m:e><m:e><m:r><m:t>&#119961;</m:t></m:r></m:e></m:d></m:oMath><![endif]--><span
style='font-weight:bold;font-family:"Cambria Math"' lang=en-US><span
style='mso-spacerun:yes'>  </span></span><span style='font-weight:bold;
font-family:微软雅黑' lang=zh-CN>这个高斯分布的均值和方差。</span><span style='font-family:微软雅黑'
lang=zh-CN>第二部分是</span><span style='font-weight:bold;font-family:微软雅黑'
lang=en-US>probalistic </span><span style='font-family:微软雅黑' lang=en-US>decoder</span><span
style='font-family:微软雅黑' lang=zh-CN>的</span><span style='font-family:微软雅黑'
lang=en-US>loss</span><span style='font-family:微软雅黑' lang=zh-CN>，由于假设了</span><span
style='font-family:微软雅黑' lang=en-US> probalistic decoder </span><!--[if gte msEquation 12]><m:oMath xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"><m:sSub><m:sSubPr><m:ctrlPr/></m:sSubPr><m:e><m:r><m:t>&#119901;</m:t></m:r></m:e><m:sub><m:r><m:t>&#120579;</m:t></m:r></m:sub></m:sSub><m:d><m:dPr><m:ctrlPr/></m:dPr><m:e><m:r><m:t>&#119909;</m:t></m:r></m:e><m:e><m:r><m:t>&#119911;</m:t></m:r></m:e></m:d></m:oMath><![endif]--><span
style='font-family:微软雅黑' lang=zh-CN>是高斯分布，所以这一项</span><span style='font-family:
微软雅黑' lang=en-US><span style='mso-spacerun:yes'>  </span></span><!--[if gte msEquation 12]><m:oMath xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"><m:sSub><m:sSubPr><m:ctrlPr/></m:sSubPr><m:e><m:r><m:t>&#119901;</m:t></m:r></m:e><m:sub><m:r><m:t>&#120579;</m:t></m:r></m:sub></m:sSub><m:d><m:dPr><m:ctrlPr/></m:dPr><m:e><m:r><m:t>&#119909;</m:t></m:r></m:e><m:e><m:r><m:t>&#119911;</m:t></m:r></m:e></m:d></m:oMath><![endif]--><span
style='font-family:微软雅黑' lang=zh-CN>是可以写成解析形式的公式，神经网络的输入是</span><span
style='font-family:"Cambria Math"' lang=en-US>z(i)</span><span
style='font-family:SimSun' lang=zh-CN>，输出是</span><span style='font-family:微软雅黑'
lang=en-US>probalistic decoder </span><!--[if gte msEquation 12]><m:oMath xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"><m:sSub><m:sSubPr><m:ctrlPr/></m:sSubPr><m:e><m:r><m:t>&#119901;</m:t></m:r></m:e><m:sub><m:r><m:t>&#120579;</m:t></m:r></m:sub></m:sSub><m:d><m:dPr><m:ctrlPr/></m:dPr><m:e><m:r><m:t>&#119909;</m:t></m:r></m:e><m:e><m:r><m:t>&#119911;</m:t></m:r></m:e></m:d></m:oMath><![endif]--><span
style='font-weight:bold;font-family:微软雅黑' lang=zh-CN>这个高斯分布的参数，即均值和方差，然后将均值方差代入高斯分布的概率密度公式，得到</span><![if !msEquation]><img
src="VAE%20paper.files/image019.png" width=3865 height=83><![endif]></p>

<p style='margin:0in;margin-left:3.375in'><img
src="VAE%20paper.files/image020.jpg" width=259 height=96></p>

<p style='margin:0in;margin-left:.375in;font-size:12.0pt'><span
style='font-family:微软雅黑' lang=zh-CN>这一项的结果。那么</span><span style='font-family:
微软雅黑' lang=en-US>z(i)</span><span style='font-family:微软雅黑' lang=zh-CN>是如何得到的呢，</span><span
style='font-family:微软雅黑' lang=en-US>z(i)</span><span style='font-family:微软雅黑'
lang=zh-CN>理论上是通过从</span><span style='font-weight:bold;font-family:微软雅黑'
lang=en-US> </span><!--[if gte msEquation 12]><m:oMath xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"><m:sSub><m:sSubPr><m:ctrlPr/></m:sSubPr><m:e><m:r><m:t>&#119954;</m:t></m:r></m:e><m:sub><m:r><m:t>&#120625;</m:t></m:r></m:sub></m:sSub><m:d><m:dPr><m:ctrlPr/></m:dPr><m:e><m:r><m:t>&#119963;</m:t></m:r></m:e><m:e><m:r><m:t>&#119961;</m:t></m:r></m:e></m:d></m:oMath><![endif]--><span
style='font-weight:bold;font-family:微软雅黑' lang=en-US><span
style='mso-spacerun:yes'>  </span></span><span style='font-weight:bold;
font-family:微软雅黑' lang=zh-CN>这个分布中采样得到的，但是这样的话，整个</span><span style='font-weight:
bold;font-family:微软雅黑' lang=en-US>loss</span><span style='font-weight:bold;
font-family:微软雅黑' lang=zh-CN>不可导，所以通过重参数技巧得到</span><span style='font-weight:
bold;font-family:微软雅黑' lang=en-US>z,z=u+</span><!--[if gte msEquation 12]><m:oMath xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"><m:r><m:t>&#120648;&#120656;</m:t></m:r></m:oMath><![endif]--><span
style='font-family:微软雅黑' lang=zh-CN>，其中</span><span style='font-family:微软雅黑'
lang=en-US>u</span><span style='font-family:微软雅黑' lang=zh-CN>和</span><!--[if gte msEquation 12]><m:oMath xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"><m:r><m:t>&#120648;</m:t></m:r></m:oMath><![endif]--><span
style='font-family:微软雅黑' lang=zh-CN>是</span><span style='font-family:微软雅黑'
lang=en-US>probalistic encoder </span><!--[if gte msEquation 12]><m:oMath xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"><m:sSub><m:sSubPr><m:ctrlPr/></m:sSubPr><m:e><m:r><m:t>&#119902;</m:t></m:r></m:e><m:sub><m:r><m:rPr><m:sty m:val="p"/></m:rPr><m:t>Φ</m:t></m:r></m:sub></m:sSub><m:d><m:dPr><m:ctrlPr/></m:dPr><m:e><m:r><m:t>&#119911;</m:t></m:r></m:e><m:e><m:r><m:t>&#119909;</m:t></m:r></m:e></m:d></m:oMath><![endif]--><span
style='font-family:微软雅黑' lang=zh-CN>的均值和方差。</span><![if !msEquation]><img
src="VAE%20paper.files/image021.png" width=2466 height=42><![endif]></p>

</div>

</div>

</div>

<div>

<p style='margin:0in'>&nbsp;</p>

<p style='text-align:left;margin:0in;font-family:Arial;font-size:9pt;
color:#969696;direction:ltr'>已使用 OneNote 创建。</p>

</div>

</body>

</html>
