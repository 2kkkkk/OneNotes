<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:dt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name=ProgId content=OneNote.File>
<meta name=Generator content="Microsoft OneNote 15">
<link id=Main-File rel=Main-File href=Kfold.htm>
<link rel=File-List href="Kfold.files/filelist.xml">
</head>

<body lang=zh-CN style='font-family:微软雅黑;font-size:12.0pt'>

<div style='direction:ltr;border-width:100%'>

<div style='direction:ltr;margin-top:0in;margin-left:0in;width:12.4979in'>

<div style='direction:ltr;margin-top:0in;margin-left:0in;width:1.1555in'>

<p style='margin:0in;font-size:20.0pt' lang=en-US><span style='font-family:
"Calibri Light"'>K</span><span style='font-family:"Microsoft YaHei Light"'>fold</span></p>

</div>

<div style='direction:ltr;margin-top:.0423in;margin-left:0in;width:1.6687in'>

<p style='margin:0in;font-size:10.0pt;color:#767676'><span style='font-family:
Calibri'>2025</span><span style='font-family:"Microsoft YaHei"'>年</span><span
style='font-family:Calibri'>3</span><span style='font-family:"Microsoft YaHei"'>月</span><span
style='font-family:Calibri'>19</span><span style='font-family:"Microsoft YaHei"'>日</span></p>

<p style='margin:0in;font-family:Calibri;font-size:10.0pt;color:#767676'>10:19</p>

</div>

<div style='direction:ltr;margin-top:.2673in;margin-left:.4597in;width:12.0381in'>

<p style='margin:0in;font-family:微软雅黑;font-size:12.0pt;color:#222832'>KFold：</p>

<p style='margin:0in;margin-left:.375in;font-family:微软雅黑;font-size:12.0pt'><span
style='font-weight:bold;font-style:italic;color:#222832'>class&nbsp;</span><span
style='font-weight:bold;color:#222832'>sklearn.model_selection.KFold(</span><span
style='font-weight:bold;font-style:italic;color:#222832'>n_splits</span><span
style='font-style:italic;color:#222832'>=5</span><span style='font-weight:bold;
color:#222832'>,&nbsp;</span><span style='font-style:italic;color:#222832'>*</span><span
style='font-weight:bold;color:#222832'>,&nbsp;</span><span style='font-weight:
bold;font-style:italic;color:#222832'>shuffle</span><span style='font-style:
italic;color:#222832'>=False</span><span style='font-weight:bold;color:#222832'>,&nbsp;</span><span
style='font-weight:bold;font-style:italic;color:#222832'>random_state</span><span
style='font-style:italic;color:#222832'>=None</span><span style='font-weight:
bold;color:#222832'>)</span><a
href="https://github.com/scikit-learn/scikit-learn/blob/98ed9dc73/sklearn/model_selection/_split.py#L436"><span
style='font-weight:bold'>[source]</span></a><a
href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.KFold.html#sklearn.model_selection.KFold"><span
style='font-weight:bold'>#</span></a></p>

<p style='margin:0in;margin-left:.375in;font-size:12.0pt'><span
style='font-family:Calibri' lang=en-US>Kfold</span><span style='font-family:
"Microsoft YaHei"' lang=zh-CN>是最简单的情形，将所有样本分为</span><span style='font-family:
"Microsoft YaHei"' lang=en-US>n</span><span style='font-family:"Microsoft YaHei"'
lang=zh-CN>份，每次取其中一份作为</span><span style='font-family:"Microsoft YaHei"'
lang=en-US>valid set</span><span style='font-family:"Microsoft YaHei"'
lang=zh-CN>，其他</span><span style='font-family:"Microsoft YaHei"' lang=en-US>n-1</span><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>份作为</span><span
style='font-family:"Microsoft YaHei"' lang=en-US>train set</span><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>，共</span><span
style='font-family:"Microsoft YaHei"' lang=en-US>n</span><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>次。</span></p>

<p style='margin:0in;margin-left:.375in;font-family:"Microsoft YaHei";
font-size:12.0pt'>&nbsp;</p>

<p style='margin:0in;font-family:"Microsoft YaHei";font-size:12.0pt;color:#222832'>GroupKFold</p>

<p style='margin:0in;margin-left:.375in;font-family:"Microsoft YaHei";
font-size:12.0pt'><span style='font-weight:bold;font-style:italic;color:#222832'>class&nbsp;</span><span
style='font-weight:bold;color:#222832'>sklearn.model_selection.GroupKFold(</span><span
style='font-weight:bold;font-style:italic;color:#222832'>n_splits</span><span
style='font-style:italic;color:#222832'>=5</span><span style='font-weight:bold;
color:#222832'>,&nbsp;</span><span style='font-style:italic;color:#222832'>*</span><span
style='font-weight:bold;color:#222832'>,&nbsp;</span><span style='font-weight:
bold;font-style:italic;color:#222832'>shuffle</span><span style='font-style:
italic;color:#222832'>=False</span><span style='font-weight:bold;color:#222832'>,&nbsp;</span><span
style='font-weight:bold;font-style:italic;color:#222832'>random_state</span><span
style='font-style:italic;color:#222832'>=None</span><span style='font-weight:
bold;color:#222832'>)</span><a
href="https://github.com/scikit-learn/scikit-learn/blob/98ed9dc73/sklearn/model_selection/_split.py#L532"><span
style='font-weight:bold'>[source]</span></a></p>

<p style='margin:0in;margin-left:.75in;font-family:"Microsoft YaHei";
font-size:12.0pt;color:#222832'>K-fold iterator variant with non-overlapping
groups.</p>

<p style='margin:0in;margin-left:.75in;font-family:"Microsoft YaHei";
font-size:12.0pt;color:#222832'>Each group will appear exactly <span
style='font-weight:bold'>once</span> in the test set across all folds (the
number of distinct groups has to be at least equal to the number of folds).</p>

<p style='margin:0in;margin-left:.75in;font-family:"Microsoft YaHei";
font-size:12.0pt;color:#222832'>The folds are approximately <span
style='font-weight:bold'>balanced</span> in the sense that the<span
style='font-weight:bold'> number of samples is approximately the same in each
test fold</span> when&nbsp;shuffle&nbsp;is True.</p>

<p style='margin:0in;margin-left:.75in;font-family:"Microsoft YaHei";
font-size:12.0pt;color:#222832' lang=en-US>&nbsp;</p>

<p style='margin:0in;margin-left:.75in;font-size:12.0pt;color:#222832'><span
style='font-family:Calibri' lang=en-US>G</span><span style='font-family:"Microsoft YaHei"'
lang=en-US>roupKfold</span><span style='font-family:"Microsoft YaHei"'
lang=zh-CN>不是独立地看待所有样本，每个样本都属于一个</span><span style='font-family:"Microsoft YaHei"'
lang=en-US>Group</span><span style='font-family:"Microsoft YaHei"' lang=zh-CN>，类似于每个学生属于一个班级，</span><span
style='font-family:"Microsoft YaHei"' lang=en-US>Groupkfold</span><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>就是以班级为单位来划分训练集和验证集，且每个班级只能出现在验证集一次。比如共有</span><span
style='font-family:"Microsoft YaHei"' lang=en-US>10</span><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>个班级（</span><span
style='font-family:"Microsoft YaHei"' lang=en-US>10</span><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>个</span><span
style='font-family:"Microsoft YaHei"' lang=en-US>Group</span><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>），</span><span
style='font-family:"Microsoft YaHei"' lang=en-US>n_splilts=5</span><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>，那么第一个</span><span
style='font-family:"Microsoft YaHei"' lang=en-US>Fold</span><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>是一班和二班做验证集，第二个</span><span
style='font-family:"Microsoft YaHei"' lang=en-US>Fold</span><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>是三班和四班做验证集，</span><span
style='font-family:"Microsoft YaHei"' lang=en-US>……</span><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>，验证集的大小不一定是两个班级，划分的标准是 the</span><span
style='font-weight:bold;font-family:"Microsoft YaHei"' lang=zh-CN> number of
samples is approximately the same in each test fold when&nbsp;shuffle&nbsp;is
True，当</span><span style='font-weight:bold;font-family:"Microsoft YaHei"'
lang=en-US>shuflle</span><span style='font-weight:bold;font-family:"Microsoft YaHei"'
lang=zh-CN>是</span><span style='font-weight:bold;font-family:"Microsoft YaHei"'
lang=en-US>False</span><span style='font-weight:bold;font-family:"Microsoft YaHei"'
lang=zh-CN>时，</span><span style='font-weight:bold;font-family:"Microsoft YaHei"'
lang=en-US> </span><span style='font-weight:bold;font-family:"Microsoft YaHei"'
lang=zh-CN>划分的标准是每个</span><span style='font-weight:bold;font-family:"Microsoft YaHei"'
lang=en-US>fold</span><span style='font-weight:bold;font-family:"Microsoft YaHei"'
lang=zh-CN>的</span><span style='font-weight:bold;font-family:"Microsoft YaHei"'
lang=en-US>G</span><span style='font-weight:bold;font-family:"Microsoft YaHei"'
lang=zh-CN>roup的数量尽可能均匀，而不是样本数量尽可能均匀。</span></p>

<p style='margin:0in;margin-left:.75in;font-family:"Microsoft YaHei";
font-size:12.0pt;color:#222832'>&nbsp;</p>

<p style='margin:0in;font-family:"Microsoft YaHei";font-size:12.0pt;color:#222832'>StratifiedKFold</p>

<p style='margin:0in;margin-left:.375in;font-family:"Microsoft YaHei";
font-size:12.0pt'><span style='font-weight:bold;font-style:italic;color:#222832'>class&nbsp;</span><span
style='font-weight:bold;color:#222832'>sklearn.model_selection.StratifiedKFold(</span><span
style='font-weight:bold;font-style:italic;color:#222832'>n_splits</span><span
style='font-style:italic;color:#222832'>=5</span><span style='font-weight:bold;
color:#222832'>,&nbsp;</span><span style='font-style:italic;color:#222832'>*</span><span
style='font-weight:bold;color:#222832'>,&nbsp;</span><span style='font-weight:
bold;font-style:italic;color:#222832'>shuffle</span><span style='font-style:
italic;color:#222832'>=False</span><span style='font-weight:bold;color:#222832'>,&nbsp;</span><span
style='font-weight:bold;font-style:italic;color:#222832'>random_state</span><span
style='font-style:italic;color:#222832'>=None</span><span style='font-weight:
bold;color:#222832'>)</span><a
href="https://github.com/scikit-learn/scikit-learn/blob/98ed9dc73/sklearn/model_selection/_split.py#L686"><span
style='font-weight:bold'>[source]</span></a></p>

<p style='margin:0in;margin-left:.75in;font-family:"Microsoft YaHei";
font-size:12.0pt;color:#222832'>Stratified K-Fold cross-validator.</p>

<p style='margin:0in;margin-left:.75in;font-family:"Microsoft YaHei";
font-size:12.0pt;color:#222832'>Provides train/test indices to split data in
train/test sets.</p>

<p style='margin:0in;margin-left:.75in;font-family:"Microsoft YaHei";
font-size:12.0pt;color:#222832'>This cross-validation object is a variation of
KFold that returns stratified folds. The folds are made by preserving the
percentage of samples for each class.</p>

<p style='margin:0in;margin-left:.75in;font-family:"Microsoft YaHei";
font-size:12.0pt;color:#222832'>&nbsp;</p>

<p style='margin:0in;margin-left:.75in;font-size:12.0pt;color:#222832'><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>假设</span><span
style='font-family:Calibri' lang=en-US>n_</span><span style='font-family:"Microsoft YaHei"'
lang=en-US>= 5</span><span style='font-family:"Microsoft YaHei"' lang=zh-CN>，那么StratifiedKFold将每个类别的样本都分为</span><span
style='font-family:"Microsoft YaHei"' lang=en-US>5</span><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>份，然后每个</span><span
style='font-family:"Microsoft YaHei"' lang=en-US>Fold</span><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>从所有类别中各取出一份，组成这个</span><span
style='font-family:"Microsoft YaHei"' lang=en-US>Fold</span><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>。</span></p>

<p style='margin:0in;font-family:Calibri;font-size:12.0pt'>&nbsp;</p>

<p style='margin:0in;font-family:"Microsoft YaHei";font-size:12.0pt'>&nbsp;</p>

<p style='margin:0in;font-family:"Microsoft YaHei";font-size:12.0pt;color:#222832'>StratifiedGroupKFold</p>

<p style='margin:0in;margin-left:.375in;font-family:"Microsoft YaHei";
font-size:12.0pt'><span style='font-weight:bold;font-style:italic;color:#222832'>class&nbsp;</span><span
style='font-weight:bold;color:#222832'>sklearn.model_selection.StratifiedGroupKFold(</span><span
style='font-weight:bold;font-style:italic;color:#222832'>n_splits</span><span
style='font-style:italic;color:#222832'>=5</span><span style='font-weight:bold;
color:#222832'>,&nbsp;</span><span style='font-weight:bold;font-style:italic;
color:#222832'>shuffle</span><span style='font-style:italic;color:#222832'>=False</span><span
style='font-weight:bold;color:#222832'>,&nbsp;</span><span style='font-weight:
bold;font-style:italic;color:#222832'>random_state</span><span
style='font-style:italic;color:#222832'>=None</span><span style='font-weight:
bold;color:#222832'>)</span><a
href="https://github.com/scikit-learn/scikit-learn/blob/98ed9dc73/sklearn/model_selection/_split.py#L885"><span
style='font-weight:bold'>[source]</span></a></p>

<p style='margin:0in;margin-left:.75in;font-family:"Microsoft YaHei";
font-size:12.0pt;color:#222832'>Stratified K-Fold iterator variant with
non-overlapping groups.</p>

<p style='margin:0in;margin-left:.75in;font-family:"Microsoft YaHei";
font-size:12.0pt;color:#222832'>This cross-validation object is a variation of
StratifiedKFold attempts to return stratified folds with non-overlapping
groups. The folds are made by preserving the percentage of samples for each
class.</p>

<p style='margin:0in;margin-left:.75in;font-family:"Microsoft YaHei";
font-size:12.0pt;color:#222832'>Each group will appear exactly once in the test
set across all folds (the number of distinct groups has to be at least equal to
the number of folds).</p>

<p style='margin:0in;margin-left:.75in;font-family:"Microsoft YaHei";
font-size:12.0pt'><span style='color:#222832'>The difference between&nbsp;</span><a
href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GroupKFold.html#sklearn.model_selection.GroupKFold"><span
style='font-weight:bold'>GroupKFold</span></a><span style='color:#222832'>&nbsp;and&nbsp;StratifiedGroupKFold&nbsp;is
that the former attempts to create balanced folds such that the number of
distinct groups is approximately the same in each fold,
whereas&nbsp;StratifiedGroupKFold&nbsp;attempts to create folds which preserve
the percentage of samples for each class as much as possible given the
constraint of non-overlapping groups between splits.</span></p>

<p style='margin:0in;font-family:Calibri;font-size:12.0pt'>&nbsp;</p>

<p style='margin:0in;margin-left:.75in;font-family:"Microsoft YaHei";
font-size:12.0pt'>&nbsp;</p>

<p style='margin:0in;margin-left:.75in;font-size:12.0pt;color:#222832'><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>StratifiedGroupKFold首先是</span><span
style='font-family:Calibri' lang=en-US>G</span><span style='font-family:"Microsoft YaHei"'
lang=zh-CN>roup</span><span style='font-family:Calibri' lang=en-US>fold</span><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>，也就是保证每个</span><span
style='font-family:Calibri' lang=en-US>G</span><span style='font-family:"Microsoft YaHei"'
lang=en-US>roup</span><span style='font-family:"Microsoft YaHei"' lang=zh-CN>只出现在验证集中一次，StratifiedGroupKFold与</span><span
style='font-family:"Microsoft YaHei"' lang=en-US>G</span><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>rou</span><span
style='font-family:"Microsoft YaHei"' lang=en-US>pfold</span><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>的不同在于，</span><span
style='font-family:"Microsoft YaHei"' lang=en-US>Groupfold</span><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>划分的标准是确保每个</span><span
style='font-family:"Microsoft YaHei"' lang=en-US>fold</span><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>中的</span><span
style='font-family:"Microsoft YaHei"' lang=en-US>group</span><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>的数量尽可能相等，而StratifiedGroupKFold划分的标准是保证训练集和验证集的类别比例尽可能相等（只是尽可能，当</span><span
style='font-family:"Microsoft YaHei"' lang=en-US>class A</span><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>只出现在</span><span
style='font-family:"Microsoft YaHei"' lang=en-US>Gr</span><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>ou</span><span
style='font-family:"Microsoft YaHei"' lang=en-US>p 1</span><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>中时，那么当</span><span
style='font-family:"Microsoft YaHei"' lang=en-US>Group1</span><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>作验证集的时候，训练集中就没有</span><span
style='font-family:"Microsoft YaHei"' lang=en-US>class A</span><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>的样本）。</span></p>

<p style='margin:0in;margin-left:.75in;font-family:"Microsoft YaHei";
font-size:12.0pt;color:#222832'>&nbsp;</p>

<p style='margin:0in;margin-left:.375in;font-size:12.0pt;color:#222832'><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>总结：如何理解</span><span
style='font-family:Calibri' lang=en-US>Fold</span><span style='font-family:
"Microsoft YaHei"' lang=zh-CN>，</span><span style='font-family:"Microsoft YaHei"'
lang=en-US>5</span><span style='font-family:Calibri' lang=en-US>Fold</span><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>相当于将数据划分为</span><span
style='font-family:"Microsoft YaHei"' lang=en-US>5</span><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>份，每份都可以作为验证集，然后其他份作为训练集。</span></p>

<p style='margin:0in;font-family:"Microsoft YaHei";font-size:12.0pt'>&nbsp;</p>

<p style='margin:0in;font-family:"Microsoft YaHei";font-size:12.0pt'><span
style='color:#222832'>TimeSeriesSplit</span><a
href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.TimeSeriesSplit.html#timeseriessplit">#</a></p>

<p style='margin:0in;margin-left:.375in;font-family:"Microsoft YaHei";
font-size:12.0pt'><span style='font-weight:bold;font-style:italic;color:#222832'>class&nbsp;</span><span
style='font-weight:bold;color:#222832'>sklearn.model_selection.TimeSeriesSplit(</span><span
style='font-weight:bold;font-style:italic;color:#222832'>n_splits</span><span
style='font-style:italic;color:#222832'>=5</span><span style='font-weight:bold;
color:#222832'>,&nbsp;</span><span style='font-style:italic;color:#222832'>*</span><span
style='font-weight:bold;color:#222832'>,&nbsp;</span><span style='font-weight:
bold;font-style:italic;color:#222832'>max_train_size</span><span
style='font-style:italic;color:#222832'>=None</span><span style='font-weight:
bold;color:#222832'>,&nbsp;</span><span style='font-weight:bold;font-style:
italic;color:#222832'>test_size</span><span style='font-style:italic;
color:#222832'>=None</span><span style='font-weight:bold;color:#222832'>,&nbsp;</span><span
style='font-weight:bold;font-style:italic;color:#222832'>gap</span><span
style='font-style:italic;color:#222832'>=0</span><span style='font-weight:bold;
color:#222832'>)</span><a
href="https://github.com/scikit-learn/scikit-learn/blob/98ed9dc73/sklearn/model_selection/_split.py#L1091"><span
style='font-weight:bold'>[source]</span></a></p>

<p style='margin:0in;margin-left:.75in;font-family:"Microsoft YaHei";
font-size:12.0pt;color:#222832'>Time Series cross-validator.</p>

<p style='margin:0in;margin-left:.75in;font-family:"Microsoft YaHei";
font-size:12.0pt;color:#222832'>Provides train/test indices to split time
series data samples that are observed at fixed time intervals, in train/test
sets. In each split, test indices must be higher than before, and thus
shuffling in cross validator is inappropriate.</p>

<p style='margin:0in;margin-left:.75in;font-family:"Microsoft YaHei";
font-size:12.0pt'><span style='color:#222832'>This cross-validation object is a
variation of&nbsp;</span><a
href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.KFold.html#sklearn.model_selection.KFold"><span
style='font-weight:bold'>KFold</span></a><span style='color:#222832'>. In the
kth split, it returns first k folds as train set and the (k+1)th fold as test
set.</span></p>

<p style='margin:0in;font-family:Calibri;font-size:12.0pt'>&nbsp;</p>

<p style='margin:0in;margin-left:.75in;font-family:微软雅黑;font-size:12.0pt'><span
lang=zh-CN>在</span><span lang=en-US>jane street</span><span lang=zh-CN>比赛中，</span><span
lang=en-US>public 6th</span><span lang=zh-CN>的方案中</span><span lang=en-US>2fold
timeseries split.</span></p>

<p style='margin:0in;font-family:"Microsoft YaHei";font-size:12.0pt'>&nbsp;</p>

</div>

</div>

</div>

<div>

<p style='margin:0in'>&nbsp;</p>

<p style='text-align:left;margin:0in;font-family:Arial;font-size:9pt;
color:#969696;direction:ltr'>已使用 OneNote 创建。</p>

</div>

</body>

</html>
