<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:dt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name=ProgId content=OneNote.File>
<meta name=Generator content="Microsoft OneNote 15">
<link id=Main-File rel=Main-File href=bm25.htm>
<link rel=File-List href="bm25.files/filelist.xml">
</head>

<body lang=zh-CN style='font-family:微软雅黑;font-size:36.0pt'>

<div style='direction:ltr;border-width:100%'>

<div style='direction:ltr;margin-top:0in;margin-left:0in;width:30.0409in'>

<div style='direction:ltr;margin-top:0in;margin-left:0in;width:1.2986in'>

<p style='margin:0in;font-family:微软雅黑;font-size:20.0pt' lang=en-US>bm25</p>

</div>

<div style='direction:ltr;margin-top:.0423in;margin-left:0in;width:1.5979in'>

<p style='margin:0in;font-size:10.0pt;color:#767676'><span style='font-family:
Calibri'>2025</span><span style='font-family:微软雅黑'>年</span><span
style='font-family:Calibri'>8</span><span style='font-family:微软雅黑'>月</span><span
style='font-family:Calibri'>2</span><span style='font-family:微软雅黑'>日</span></p>

<p style='margin:0in;font-family:Calibri;font-size:10.0pt;color:#767676'>10:10</p>

</div>

<div style='direction:ltr;margin-top:.4777in;margin-left:0in;width:30.0409in'>

<p style='margin:0in;font-family:微软雅黑;font-size:48.0pt' lang=en-US><span
style='font-weight:bold'>tf-idf</span></p>

<p style='margin:0in;margin-left:.375in;font-family:微软雅黑;font-size:36.0pt'><span
style='font-weight:bold' lang=en-US>tf</span><span style='font-weight:bold'
lang=zh-CN>：词频，一个词t在某个文章</span><span style='font-weight:bold' lang=en-US>D</span><span
style='font-weight:bold' lang=zh-CN>中出现的频率，频率越高，</span><span style='font-weight:
bold' lang=en-US>t</span><span style='font-weight:bold' lang=zh-CN>对</span><span
style='font-weight:bold' lang=en-US>D</span><span style='font-weight:bold'
lang=zh-CN>的重要性越高。</span></p>

<p style='margin:0in;margin-left:6.75in'><img src="bm25.files/image001.jpg"
width=800 height=892></p>

<p style='margin:0in;margin-left:.375in;font-family:微软雅黑;font-size:36.0pt'
lang=en-US>&nbsp;</p>

<p style='margin:0in;margin-left:.375in;font-family:微软雅黑;font-size:36.0pt'><span
style='font-weight:bold' lang=en-US>idf</span><span style='font-weight:bold'
lang=zh-CN>：逆文档频率，语料库</span><span style='font-weight:bold' lang=en-US>C</span><span
style='font-weight:bold' lang=zh-CN>中出现词</span><span style='font-weight:bold'
lang=en-US>t</span><span style='font-weight:bold' lang=zh-CN>的文档数越多，说明词</span><span
style='font-weight:bold' lang=en-US>t</span><span style='font-weight:bold'
lang=zh-CN>可能是常用词，</span><span style='font-weight:bold' lang=en-US>t</span><span
style='font-weight:bold' lang=zh-CN>的重要性越低。</span></p>

<p style='margin:0in;margin-left:.375in;font-family:微软雅黑;font-size:36.0pt'>&nbsp;</p>

<p style='margin:0in;margin-left:4.125in'><img src="bm25.files/image002.jpg"
width=1990 height=616></p>

<p style='margin:0in;margin-left:.375in;font-family:微软雅黑;font-size:36.0pt;
color:#191B1F'><span style='background:white' lang=en-US>tf*idf</span><span
style='background:white' lang=zh-CN>，就能得到一个词的TF-IDF的值。某个词在文章中的TF-IDF越大，那么一般而言这个词在这篇文章的重要性会越高，所以通过计算文章中各个词的TF-IDF，由大到小排序，排在最前面的几个词，就是该文章的</span><span
style='font-weight:bold;background:white' lang=zh-CN>关键词</span><span
style='background:white' lang=zh-CN>。</span></p>

<p style='margin:0in;margin-left:.375in;font-family:微软雅黑;font-size:36.0pt;
color:#191B1F'>&nbsp;</p>

<p style='margin:0in;margin-left:6.0in'><img src="bm25.files/image003.jpg"
width=1267 height=123></p>

<p style='margin:0in;font-family:微软雅黑;font-size:48.0pt' lang=en-US>&nbsp;</p>

<p style='margin:0in;font-family:微软雅黑;font-size:48.0pt' lang=en-US>&nbsp;</p>

<p style='margin:0in;font-family:微软雅黑;font-size:48.0pt' lang=en-US><span
style='font-weight:bold'>bm25</span></p>

<p style='margin:0in;margin-left:.375in;font-family:微软雅黑;font-size:36.0pt'><span
lang=zh-CN>t</span><span lang=en-US>f-idf</span><span lang=zh-CN>的值和词</span><span
lang=en-US>t</span><span lang=zh-CN>在</span><span lang=en-US>d</span><span
lang=zh-CN>中出现的次数成正比，线性关系，假设</span><span lang=en-US>cat</span><span lang=zh-CN>在d中出现了</span><span
lang=en-US>10</span><span lang=zh-CN>次，</span><span lang=en-US>tfidf('cat',d,D)=0.2</span><span
lang=zh-CN>，此时令</span><span lang=en-US>cat</span><span lang=zh-CN>在d中出现</span><span
lang=en-US>20</span><span lang=zh-CN>次，那么</span><span lang=en-US>tfidf('cat',d,D)=0.4</span><span
lang=zh-CN>，</span><span style='font-weight:bold' lang=zh-CN>但是词频和相关性之间的关系可能是非线性的。</span></p>

<p style='margin:0in;margin-left:.375in;font-family:微软雅黑;font-size:36.0pt'>&nbsp;</p>

<p style='margin:0in;margin-left:.375in;font-family:微软雅黑;font-size:36.0pt'><span
style='font-weight:bold' lang=zh-CN>qu</span><span style='font-weight:bold'
lang=en-US>ery Q</span><span style='font-weight:bold' lang=zh-CN>和文档</span><span
style='font-weight:bold' lang=en-US>D</span><span style='font-weight:bold'
lang=zh-CN>的相似度得分</span><span style='font-weight:bold' lang=en-US>= Q</span><span
style='font-weight:bold' lang=zh-CN>中的所有</span><span style='font-weight:bold'
lang=en-US>token</span><span style='font-weight:bold' lang=zh-CN>，和</span><span
style='font-weight:bold' lang=en-US>D</span><span style='font-weight:bold'
lang=zh-CN>的</span><span style='font-weight:bold' lang=en-US>bm25</span><span
style='font-weight:bold' lang=zh-CN>分数，求和。</span></p>

<p style='margin:0in;margin-left:.375in;font-family:微软雅黑;font-size:36.0pt'>&nbsp;</p>

<p style='margin:0in;margin-left:3.375in'><img src="bm25.files/image004.jpg"
width=2084 height=1538></p>

<p style='margin:0in;margin-left:.375in;font-family:微软雅黑;font-size:36.0pt'>&nbsp;</p>

<p style='margin:0in;font-family:微软雅黑;font-size:36.0pt'><span style='font-weight:
bold' lang=zh-CN>总结：</span><span style='font-weight:bold' lang=en-US>bm25</span><span
style='font-weight:bold' lang=zh-CN>是对</span><span style='font-weight:bold'
lang=en-US>tf-idf</span><span style='font-weight:bold' lang=zh-CN>的改进，</span><span
style='font-weight:bold' lang=en-US>tf-idf</span><span style='font-weight:bold'
lang=zh-CN>和</span><span style='font-weight:bold' lang=en-US>bm25</span><span
style='font-weight:bold' lang=zh-CN>都可以用来得到文档的关键词，当然也都可以用上图中的公式来得到</span><span
style='font-weight:bold' lang=en-US>query Q</span><span style='font-weight:
bold' lang=zh-CN>和文档</span><span style='font-weight:bold' lang=en-US>D</span><span
style='font-weight:bold' lang=zh-CN>的相似度分数。还可以通过</span><span style='font-weight:
bold' lang=en-US>tf-idf/bm25</span><span style='font-weight:bold' lang=zh-CN>稀疏矩阵，通过向量相似度来计算两个文档之间或</span><span
style='font-weight:bold' lang=en-US>Q</span><span style='font-weight:bold'
lang=zh-CN>和</span><span style='font-weight:bold' lang=en-US>D</span><span
style='font-weight:bold' lang=zh-CN>的得分。</span></p>

<p style='margin:0in;font-family:微软雅黑;font-size:36.0pt'><span style='font-weight:
bold'>再总结：</span></p>

<p style='margin:0in;margin-left:.375in;font-family:微软雅黑;font-size:36.0pt'><span
style='font-weight:bold' lang=zh-CN>有</span><span style='font-weight:bold'
lang=en-US>2</span><span style='font-weight:bold' lang=zh-CN>种方式计算</span><span
style='font-weight:bold' lang=en-US>query Q</span><span style='font-weight:
bold' lang=zh-CN>和文档</span><span style='font-weight:bold' lang=en-US> D</span><span
style='font-weight:bold' lang=zh-CN>的相似度：</span></p>

<p style='margin:0in;margin-left:.375in;font-family:微软雅黑;font-size:36.0pt'><span
style='font-weight:bold' lang=en-US>1</span><span style='font-weight:bold'
lang=zh-CN>）qu</span><span style='font-weight:bold' lang=en-US>ery Q</span><span
style='font-weight:bold' lang=zh-CN>和文档</span><span style='font-weight:bold'
lang=en-US>D</span><span style='font-weight:bold' lang=zh-CN>的相似度得分</span><span
style='font-weight:bold' lang=en-US>= Q</span><span style='font-weight:bold'
lang=zh-CN>中的所有</span><span style='font-weight:bold' lang=en-US>token</span><span
style='font-weight:bold' lang=zh-CN>，和</span><span style='font-weight:bold'
lang=en-US>D</span><span style='font-weight:bold' lang=zh-CN>的</span><span
style='font-weight:bold' lang=en-US>bm25</span><span style='font-weight:bold'
lang=zh-CN>分数</span><span style='font-weight:bold' lang=en-US>/tfidf</span><span
style='font-weight:bold' lang=zh-CN>分数，求和。</span></p>

<p style='margin:0in;margin-left:.375in;font-family:微软雅黑;font-size:36.0pt'><span
style='font-weight:bold' lang=en-US>2</span><span style='font-weight:bold'
lang=zh-CN>）</span><span style='font-weight:bold' lang=en-US>query Q</span><span
style='font-weight:bold' lang=zh-CN>的稀疏向量，向量长度为</span><span style='font-weight:
bold' lang=en-US>n</span><span style='font-weight:bold' lang=zh-CN>，为语料库中所有</span><span
style='font-weight:bold' lang=en-US>token</span><span style='font-weight:bold'
lang=zh-CN>的个数，向量中每个元素是</span><span style='font-weight:bold' lang=en-US>token</span><span
style='font-weight:bold' lang=zh-CN>和</span><span style='font-weight:bold'
lang=en-US>Q</span><span style='font-weight:bold' lang=zh-CN>的</span><span
style='font-weight:bold' lang=en-US>bm25</span><span style='font-weight:bold'
lang=zh-CN>分数</span><span style='font-weight:bold' lang=en-US>/tfidf</span><span
style='font-weight:bold' lang=zh-CN>分数；</span></p>

<p style='margin:0in;margin-left:.375in;font-family:微软雅黑;font-size:36.0pt'><span
style='font-weight:bold' lang=en-US><span style='mso-spacerun:yes'>     </span></span><span
style='font-weight:bold' lang=zh-CN>文档</span><span style='font-weight:bold'
lang=en-US>D</span><span style='font-weight:bold' lang=zh-CN>的稀疏向量，向量长度也为</span><span
style='font-weight:bold' lang=en-US>n</span><span style='font-weight:bold'
lang=zh-CN>，向量中每个元素是</span><span style='font-weight:bold' lang=en-US>token</span><span
style='font-weight:bold' lang=zh-CN>和</span><span style='font-weight:bold'
lang=en-US>D</span><span style='font-weight:bold' lang=zh-CN>的</span><span
style='font-weight:bold' lang=en-US>bm25</span><span style='font-weight:bold'
lang=zh-CN>分数</span><span style='font-weight:bold' lang=en-US>/tfidf</span><span
style='font-weight:bold' lang=zh-CN>分数；</span></p>

<p style='margin:0in;margin-left:.375in;font-family:微软雅黑;font-size:36.0pt'><span
style='font-weight:bold' lang=en-US><span style='mso-spacerun:yes'>     </span></span><span
style='font-weight:bold' lang=zh-CN>然后两个向量计算相似度。</span></p>

<p style='margin:0in;margin-left:.375in;font-family:微软雅黑;font-size:36.0pt'>第一种方法（对
query 中所有 token 与文档的 BM25/TF-IDF
分数求和）更快，核心原因是其计算复杂度更低，且避免了稀疏向量构建与高维度匹配的额外开销，具体分析如下：</p>

<ul type=disc style='direction:ltr;unicode-bidi:embed;margin-top:0in;
 margin-bottom:0in'>
 <li style='margin-top:0;margin-bottom:0;vertical-align:middle;color:black'><span
     style='font-weight:bold;font-family:微软雅黑;font-size:36.0pt;color:black'>第一种方法</span><span
     style='font-family:微软雅黑;font-size:36.0pt;color:black'>：<br>
          仅需遍历 query 中的所有 token（假设 query 长度为m，通常为几个到十几个词），对每个 token 计算其在文档中的
     BM25/TF-IDF 分数，最后累加求和。<br>
          计算复杂度为&nbsp;</span><span style='font-weight:bold;font-family:微软雅黑;
     font-size:36.0pt;color:black'>O(m)</span><span style='font-family:微软雅黑;
     font-size:36.0pt;color:black'>（m为 query 的 token 数量），与语料库总词数（n）无关。</span></li>
 <li style='margin-top:0;margin-bottom:0;vertical-align:middle;color:black'><span
     style='font-weight:bold;font-family:微软雅黑;font-size:36.0pt;color:black'>第二种方法</span><span
     style='font-family:微软雅黑;font-size:36.0pt;color:black'>：<br>
          需先为 query 和文档构建长度为n（语料库总 token
     数，可能达数万至数十万）的稀疏向量，再计算向量相似度（如余弦相似度）。<br>
          过程包括：</span></li>
 <ul type=circle style='direction:ltr;unicode-bidi:embed;margin-top:0in;
  margin-bottom:0in'>
  <li style='margin-top:0;margin-bottom:0;vertical-align:middle;margin-top:
      3pt;margin-bottom:0pt'><span style='font-family:微软雅黑;font-size:36.0pt'>遍历语料库词表构建向量（复杂度O(n)）；</span></li>
  <li style='margin-top:0;margin-bottom:0;vertical-align:middle;margin-top:
      3pt;margin-bottom:0pt'><span style='font-family:微软雅黑;font-size:36.0pt'>计算向量相似度时，需匹配两个向量的非零维度（即使稀疏，仍需处理词表索引映射，复杂度与n相关）。</span></li>
 </ul>
</ul>

<p style='margin-left:.375in;margin-top:0pt;margin-bottom:9pt;font-family:微软雅黑;
font-size:36.0pt'>&nbsp;</p>

<p style='margin:0in;margin-left:.375in;font-family:微软雅黑;font-size:42.0pt'>&nbsp;</p>

<p style='margin:0in;margin-left:.375in;font-family:微软雅黑;font-size:42.0pt'><span
style='font-weight:bold' lang=zh-CN>对于抽取式问答来说，文章和问题涉及到关键词这种类型的，</span><span
style='font-weight:bold' lang=en-US>bm25</span><span style='font-weight:bold'
lang=zh-CN>是很适合文章和问题都有关键词的。b</span><span style='font-weight:bold' lang=en-US>m25</span><span
style='font-weight:bold' lang=zh-CN>就是一种基于关键词的</span><span style='font-weight:
bold' lang=en-US> </span><span style='font-weight:bold' lang=zh-CN>算法。</span></p>

</div>

</div>

</div>

<div>

<p style='margin:0in'>&nbsp;</p>

<p style='text-align:left;margin:0in;font-family:Arial;font-size:9pt;
color:#969696;direction:ltr'>已使用 OneNote 创建。</p>

</div>

</body>

</html>
