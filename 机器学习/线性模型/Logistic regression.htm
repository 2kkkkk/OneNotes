<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:dt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name=ProgId content=OneNote.File>
<meta name=Generator content="Microsoft OneNote 15">
<link id=Main-File rel=Main-File href="Logistic%20regression.htm">
<link rel=File-List href="Logistic%20regression.files/filelist.xml">
</head>

<body lang=zh-CN style='font-family:微软雅黑;font-size:36.0pt'>

<div style='direction:ltr;border-width:100%'>

<div style='direction:ltr;margin-top:0in;margin-left:0in;width:29.3861in'>

<div style='direction:ltr;margin-top:0in;margin-left:0in;width:2.8243in'>

<p style='margin:0in;font-size:20.0pt' lang=en-US><span style='font-family:
"Calibri Light"'>L</span><span style='font-family:"Microsoft YaHei Light"'>ogistic
regression</span></p>

</div>

<div style='direction:ltr;margin-top:.0423in;margin-left:0in;width:1.6687in'>

<p style='margin:0in;font-size:10.0pt;color:#767676'><span style='font-family:
Calibri'>2025</span><span style='font-family:"Microsoft YaHei"'>年</span><span
style='font-family:Calibri'>3</span><span style='font-family:"Microsoft YaHei"'>月</span><span
style='font-family:Calibri'>24</span><span style='font-family:"Microsoft YaHei"'>日</span></p>

<p style='margin:0in;font-family:Calibri;font-size:10.0pt;color:#767676'>16:03</p>

</div>

<div style='direction:ltr;margin-top:.3479in;margin-left:0in;width:29.3861in'>

<p style='margin:0in;font-family:微软雅黑;font-size:36.0pt'><span style='font-weight:
bold'>建模：</span></p>

<p style='margin:0in;margin-left:.375in;font-family:微软雅黑;font-size:36.0pt'><span
lang=zh-CN>二分类问题，也就是求二项分布的概率</span><span lang=en-US>p</span><span lang=zh-CN>，由于</span><span
lang=en-US>p</span><span lang=zh-CN>取值范围是</span><span lang=en-US>[0,1]</span><span
lang=zh-CN>，而线性模型</span><span lang=en-US>wx+b</span><span lang=zh-CN>的取值范围是</span><span
lang=en-US>[-inf,inf]</span><span lang=zh-CN>，所以对不直接用线性模型拟合</span><span
lang=en-US>p</span><span lang=zh-CN>。</span><span lang=en-US>Odds=p/1-p</span><span
lang=zh-CN>，取值范围是</span><span lang=en-US>[0,inf]</span><span lang=zh-CN>，</span><span
lang=en-US>log(odds)</span><span lang=zh-CN>的取值范围是</span><span lang=en-US>[-inf,inf]</span><span
lang=zh-CN>，因此，用线性模型来拟合</span><span lang=en-US>log(odds)</span><span
lang=zh-CN>，然后再将</span><span lang=en-US>log(odds)</span><span lang=zh-CN>转换为</span><span
lang=en-US>p</span><span lang=zh-CN>，就得到了分类概率。</span></p>

<p style='margin:0in;margin-left:.375in;font-size:36.0pt'><span
style='font-family:微软雅黑' lang=zh-CN>将</span><span style='font-family:Calibri'
lang=en-US>log(odds)</span><span style='font-family:"Microsoft YaHei"'
lang=zh-CN>转换为</span><span style='font-family:Calibri' lang=en-US>p</span><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>，用到的就是</span><span
style='font-family:"Microsoft YaHei"' lang=en-US>Sigmoid</span><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>函数，</span><span
style='font-family:"Microsoft YaHei"' lang=en-US>log(odds)</span><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>也称为</span><span
style='font-family:"Microsoft YaHei"' lang=en-US>logits.</span></p>

<p style='margin:0in;font-family:"Microsoft YaHei";font-size:36.0pt'
lang=en-US>&nbsp;</p>

<p style='margin:0in;font-family:"Microsoft YaHei";font-size:36.0pt'><span
style='font-weight:bold'>策略（定义损失函数）：</span></p>

<p style='margin:0in;margin-left:.375in;font-size:36.0pt'><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>用线性回归模型来拟合</span><span
style='font-family:微软雅黑' lang=en-US>log(odds)</span><span style='font-family:
微软雅黑' lang=zh-CN>，可以像线性回归一样用</span><span style='font-family:Calibri'
lang=en-US>mse</span><span style='font-family:"Microsoft YaHei"' lang=zh-CN>来优化吗？不可以。因为数据的标签</span><span
style='font-family:Calibri' lang=en-US>y</span><span style='font-family:"Microsoft YaHei"'
lang=zh-CN>是</span><span style='font-family:"Microsoft YaHei"' lang=en-US>0</span><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>或</span><span
style='font-family:"Microsoft YaHei"' lang=en-US>1</span><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>，</span><span
style='font-family:"Microsoft YaHei"' lang=en-US>log(odds)</span><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>就是</span><span
style='font-family:"Microsoft YaHei"' lang=en-US>-inf</span><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>或</span><span
style='font-family:"Microsoft YaHei"' lang=en-US>inf</span><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>，也就无法计算</span><span
style='font-family:"Microsoft YaHei"' lang=en-US>mse</span><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>。</span></p>

<p style='margin:0in;margin-left:.375in;font-size:36.0pt'><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>用似然函数作为</span><span
style='font-family:Calibri' lang=en-US>loss</span><span style='font-family:
"Microsoft YaHei"' lang=zh-CN>，用线性模型计算得到的</span><span style='font-family:Calibri'
lang=en-US>log(odds)</span><span style='font-family:"Microsoft YaHei"'
lang=zh-CN>，转换得到</span><span style='font-family:Calibri' lang=en-US>P(x)</span><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>，似然</span><span
style='font-family:Calibri' lang=en-US>likelihood</span><span style='font-family:
"Microsoft YaHei"' lang=en-US> =<span style='mso-spacerun:yes'>  </span></span><!--[if gte msEquation 12]><m:oMath xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"><m:r><m:rPr><m:sty m:val="p"/></m:rPr><m:t>P</m:t></m:r><m:d><m:dPr><m:ctrlPr/></m:dPr><m:e><m:sSub><m:sSubPr><m:ctrlPr/></m:sSubPr><m:e><m:r><m:t>&#119909;</m:t></m:r></m:e><m:sub><m:r><m:t>1</m:t></m:r></m:sub></m:sSub></m:e></m:d><m:r><m:t>∗</m:t></m:r><m:r><m:rPr><m:sty m:val="p"/></m:rPr><m:t>P</m:t></m:r><m:d><m:dPr><m:ctrlPr/></m:dPr><m:e><m:sSub><m:sSubPr><m:ctrlPr/></m:sSubPr><m:e><m:r><m:t>&#119909;</m:t></m:r></m:e><m:sub><m:r><m:t>2</m:t></m:r></m:sub></m:sSub></m:e></m:d><m:r><m:t>∗</m:t></m:r><m:r><m:rPr><m:sty m:val="p"/></m:rPr><m:t>P</m:t></m:r><m:d><m:dPr><m:ctrlPr/></m:dPr><m:e><m:sSub><m:sSubPr><m:ctrlPr/></m:sSubPr><m:e><m:r><m:t>&#119909;</m:t></m:r></m:e><m:sub><m:r><m:t>3</m:t></m:r></m:sub></m:sSub></m:e></m:d><m:r><m:t>∗</m:t></m:r><m:r><m:t>………</m:t></m:r></m:oMath><![endif]--><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>，取对数就变成了相加的形式，</span><span
style='font-family:SimSun' lang=en-US>log(</span><span style='font-family:SimSun'
lang=zh-CN>似然</span><span style='font-family:SimSun' lang=en-US>)=</span><!--[if gte msEquation 12]><m:oMath xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"><m:sSup><m:sSupPr><m:ctrlPr/></m:sSupPr><m:e><m:r><m:t>&#119897;&#119900;&#119892;</m:t></m:r></m:e><m:sup><m:r><m:t>&#119875;</m:t></m:r><m:r><m:t>(</m:t></m:r><m:r><m:t>&#119909;</m:t></m:r><m:r><m:t>1)</m:t></m:r></m:sup></m:sSup><m:r><m:t>+</m:t></m:r><m:sSup><m:sSupPr><m:ctrlPr/></m:sSupPr><m:e><m:r><m:t>&#119897;&#119900;&#119892;</m:t></m:r></m:e><m:sup><m:r><m:t>&#119875;</m:t></m:r><m:r><m:t>(</m:t></m:r><m:r><m:t>&#119909;</m:t></m:r><m:r><m:t>2)</m:t></m:r></m:sup></m:sSup><m:sSup><m:sSupPr><m:ctrlPr/></m:sSupPr><m:e><m:r><m:t>+</m:t></m:r><m:r><m:t>&#119897;&#119900;&#119892;</m:t></m:r></m:e><m:sup><m:r><m:t>&#119875;</m:t></m:r><m:r><m:t>(</m:t></m:r><m:r><m:t>&#119909;</m:t></m:r><m:r><m:t>3)</m:t></m:r></m:sup></m:sSup><m:r><m:t>+</m:t></m:r><m:r><m:t>……</m:t></m:r></m:oMath><![endif]--><span
style='font-family:SimSun' lang=en-US>,<span style='mso-spacerun:yes'>  
</span>log(</span><span style='font-family:SimSun' lang=zh-CN>似然</span><span
style='font-family:SimSun' lang=en-US>)</span><span style='font-family:SimSun'
lang=zh-CN>即交叉熵损失函数。</span><![if !msEquation]><img
src="Logistic%20regression.files/image001.png" width=4193 height=248><![endif]></p>

<p style='margin:0in;margin-left:.375in;font-family:SimSun;font-size:36.0pt'>&nbsp;</p>

<p style='margin:0in;font-size:36.0pt'><span style='font-weight:bold;
font-family:"Microsoft YaHei"' lang=zh-CN>多分类</span><span style='font-weight:
bold;font-family:Calibri' lang=en-US>softmax</span><span style='font-weight:
bold;font-family:"Microsoft YaHei"' lang=zh-CN>回归：</span></p>

<p style='margin:0in;margin-left:.375in;font-family:"Microsoft YaHei";
font-size:36.0pt'><span lang=zh-CN>同理，多分类即多项式分布，对每个类别</span><span lang=en-US>c</span><span
lang=zh-CN>，求</span><span lang=en-US>P(c).<span style='mso-spacerun:yes'>  
</span></span></p>

<p style='margin:0in;margin-left:.375in;font-size:36.0pt'><span
style='font-family:Calibri' lang=en-US>P</span><span style='font-family:"Microsoft YaHei"'
lang=zh-CN>（</span><span style='font-family:"Microsoft YaHei"' lang=en-US>c)</span><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>可以理解为</span><span
style='font-family:"Microsoft YaHei"' lang=en-US> </span><!--[if gte msEquation 12]><m:oMath xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"><m:f><m:fPr><m:ctrlPr/></m:fPr><m:num><m:r><m:t>属于类别</m:t></m:r><m:r><m:t>&#119862;</m:t></m:r><m:r><m:t>的样本个数</m:t></m:r></m:num><m:den><m:r><m:t>总样本个数</m:t></m:r></m:den></m:f><m:r><m:t>，即</m:t></m:r><m:f><m:fPr><m:ctrlPr/></m:fPr><m:num><m:r><m:rPr><m:sty m:val="p"/></m:rPr><m:t>cou</m:t></m:r><m:r><m:t>&#119899;&#119905;</m:t></m:r></m:num><m:den><m:r><m:t>&#119904;&#119906;&#119898;</m:t></m:r></m:den></m:f></m:oMath><![endif]--><span
style='font-family:"Microsoft YaHei"' lang=zh-CN>的形式，</span><span
style='font-family:"Cambria Math"' lang=en-US>count</span><span
style='font-family:SimSun' lang=zh-CN>的取值范围是</span><span style='font-family:
微软雅黑' lang=en-US>[0,inf]</span><span style='font-family:微软雅黑' lang=zh-CN>，</span><span
style='font-family:微软雅黑' lang=en-US>log(count)</span><span style='font-family:
微软雅黑' lang=zh-CN>的取值范围是</span><span style='font-family:微软雅黑' lang=en-US>[-inf,inf]</span><span
style='font-family:微软雅黑' lang=zh-CN>，那么就可以用线性模型来拟合</span><span
style='font-family:微软雅黑' lang=en-US>log(count)</span><span style='font-family:
微软雅黑' lang=zh-CN>，</span><span style='font-family:"Cambria Math"' lang=en-US>log(count)</span><span
style='font-family:SimSun' lang=zh-CN>即</span><span style='font-family:SimSun'
lang=en-US>logits</span><span style='font-family:SimSun' lang=zh-CN>。</span><span
style='font-family:微软雅黑' lang=zh-CN>每个类别都对应一个线性模型。</span><![if !msEquation]><img
src="Logistic%20regression.files/image002.png" width=4193 height=262><![endif]></p>

<p style='margin:0in;margin-left:.375in;font-size:36.0pt'><span
style='font-family:微软雅黑' lang=zh-CN>将</span><span style='font-family:微软雅黑'
lang=en-US>Log(count)</span><span style='font-family:微软雅黑' lang=zh-CN>转换为</span><span
style='font-family:微软雅黑' lang=en-US>p</span><span style='font-family:微软雅黑'
lang=zh-CN>，用到的就是</span><span style='font-family:微软雅黑' lang=en-US>softmax</span><span
style='font-family:微软雅黑' lang=zh-CN>函数，</span><span style='font-family:"Cambria Math"'
lang=en-US>log(count)</span><span style='font-family:SimSun' lang=zh-CN>即</span><span
style='font-family:SimSun' lang=en-US>logits</span><span style='font-family:
微软雅黑' lang=zh-CN>。</span></p>

<p style='margin:0in;margin-left:.375in;font-family:微软雅黑;font-size:36.0pt'>&nbsp;</p>

<p style='margin:0in;margin-left:.375in;font-family:微软雅黑;font-size:36.0pt'>损失函数仍然是似然函数。</p>

</div>

</div>

</div>

<div>

<p style='margin:0in'>&nbsp;</p>

<p style='text-align:left;margin:0in;font-family:Arial;font-size:9pt;
color:#969696;direction:ltr'>已使用 OneNote 创建。</p>

</div>

</body>

</html>
